{% extends "base.html" %}
{% load static %}

{% block title %}Iniciar sesión - Dulcería Lilis{% endblock %}

{% block content %}
<div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh; background-color: #f8f9fa;">
<div class="card shadow-lg p-4 border-0" style="max-width: 420px; border-radius: 16px;">
    
    <!-- Logo y encabezado -->
    <div class="text-center mb-4">
    <img src="https://cdn-icons-png.flaticon.com/512/2965/2965567.png" 
        alt="Logo Dulcería" 
        style="width: 80px; height: 80px; border-radius: 50%; background: #fff; border: 2px solid #a71f1f;">
    <h3 class="mt-3 fw-bold" style="color: #a71f1f;">
        <i class="fas fa-candy-cane me-2"></i>Dulcería Lilis
    </h3>
    <p class="text-muted mb-0">Panel de gestión</p>
    </div>

    <!-- Título del formulario -->
    <h5 class="text-center mb-3 fw-semibold">Iniciar sesión</h5>

    <!-- Formulario -->
    <form method="post">
    {% csrf_token %}
    
    <div class="mb-3">
        <label class="form-label fw-semibold" for="id_username">Nombre de usuario</label>
        <div class="input-group">
        <span class="input-group-text bg-light"><i class="fas fa-user"></i></span>
        {{ form.username }}
        </div>
    </div>

    <div class="mb-3">
        <label class="form-label fw-semibold" for="id_password">Contraseña</label>
        <div class="input-group">
        <span class="input-group-text bg-light"><i class="fas fa-lock"></i></span>
        {{ form.password }}
        </div>
    </div>

    <button class="btn text-white fw-bold w-100" type="submit" style="background-color: #a71f1f;">
        <i class="fas fa-sign-in-alt me-1"></i> Entrar
    </button>

    <!-- Enlaces adicionales -->
    <div class="text-center mt-3">
        <a href="{% url 'password_reset_request' %}" class="small text-decoration-none text-muted">
        ¿Olvidaste tu contraseña?
        </a>
    </div>
    </form>

    <hr class="my-4">

    <!-- Registro -->
    <div class="text-center">
    <p class="small mb-0">¿No tienes cuenta?
        <a href="{% url 'register' %}" class="fw-bold" style="color: #a71f1f;">
        Regístrate aquí
        </a>
    </p>
    </div>
</div>
</div>

<!-- ✅ SWEETALERT2 INTEGRADO -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

{% if messages %}
<div id="django-messages" data-messages='[
    {% for message in messages %}
    {"level": "{{ message.tags }}", "text": "{{ message|escapejs }}"}{% if not forloop.last %},{% endif %}
    {% endfor %}
]'></div>
{% endif %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    const container = document.getElementById('django-messages');
    if (container) {
        const messages = JSON.parse(container.dataset.messages);
        messages.forEach(msg => {
            Swal.fire({
                title: msg.level === 'success' ? '¡Bienvenido!' :
                    msg.level === 'error' ? 'Error de inicio de sesión' :
                    msg.level.charAt(0).toUpperCase() + msg.level.slice(1),
                text: msg.text,
                icon: msg.level,
                confirmButtonColor: '#a71f1f',
                background: '#fff8f8'
            });
        });
    }
});
</script>
{% endblock %}
