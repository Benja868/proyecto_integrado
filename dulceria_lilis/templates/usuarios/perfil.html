{% extends "base_admin.html" %}
{% load static %}

{% block title %}Mi Perfil{% endblock %}

{% block content %}
<div class="container mt-4">
<h2 class="fw-bold text-danger"><i class="fas fa-user-circle me-2"></i> Mi Perfil</h2>
<div class="card shadow-sm mt-3 p-4">
    <form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="row g-3 align-items-center">
        <div class="col-md-3 text-center">
        {% if user.avatar %}
            <img src="{{ user.avatar.url }}" class="rounded-circle shadow-sm mb-3" width="120" height="120" alt="Avatar">
        {% else %}
            <img src="{% static 'images/empresa_lilis.jpg' %}" class="rounded-circle shadow-sm mb-3" width="120" height="120" alt="Sin avatar">
        {% endif %}
        {{ form.avatar }}
        </div>

        <div class="col-md-9">
        <div class="row g-3">
            <div class="col-md-6">{{ form.first_name.label_tag }} {{ form.first_name }}</div>
            <div class="col-md-6">{{ form.last_name.label_tag }} {{ form.last_name }}</div>
            <div class="col-md-6">{{ form.email.label_tag }} {{ form.email }}</div>
            <div class="col-md-6">{{ form.telefono.label_tag }} {{ form.telefono }}</div>
        </div>
        </div>
    </div>
    <div class="mt-4">
        <button class="btn btn-primary"><i class="fas fa-save me-1"></i> Guardar Cambios</button>
        <a href="{% url 'usuarios:cambiar_contrasena' %}" class="btn btn-outline-danger ms-2">
        <i class="fas fa-key me-1"></i> Cambiar Contraseña
        </a>
    </div>
    </form>
</div>
</div>

{% if form.errors %}
<script>
Swal.fire({
title: 'Error de validación',
html: `<ul style="text-align:left;">{% for field, errors in form.errors.items %}<li><b>{{ field|title }}:</b> {{ errors|join:", " }}</li>{% endfor %}</ul>`,
icon: 'error',
confirmButtonColor: '#a71f1f'
});
</script>
{% endif %}

{% endblock %}
